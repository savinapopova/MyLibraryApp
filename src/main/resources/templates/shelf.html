<!DOCTYPE html>
<html lang="en"
      xmlns:th="http://www.thymeleaf.org">
<th:block th:include="~{/fragments/head.html}"/>
<body class="d-flex flex-column min-vh-100">
<header th:include="~{/fragments/nav-and-footer/nav}"/>

  <div class='container'>
    <div class='mt-3'>
        <nav>
            <div class='nav nav-tabs' id='nav-tab' role='tablist'>
                <button class='nav-link active' id='nav-loans-tab' data-bs-toggle='tab'
                data-bs-target='#nav-loans' type='button' role='tab' aria-controls='nav-loans'
                aria-selected='true'>
                Loans
                </button>
                <button  class='nav-link' id='nav-history-tab' data-bs-toggle='tab'
                data-bs-target='#nav-history' type='button' role='tab' aria-controls='nav-history'
                aria-selected='false'>
                Your History
                </button>
            </div>
        </nav>
        <div class='tab-content' id='nav-tabContent'>
            <div class='tab-pane fade show active' id='nav-loans' role='tabpanel'
                 aria-labelledby='nav-loans-tab'>


                {/* Desktop */}
                <div class='d-none d-lg-block mt-2'>

                    <h5>Current Loans: </h5>

                    <div th:if="${loans.size() > 0}">
                        <div th:each="l: ${loans}">

                             <div class='row mt-3 mb-3'>
                            <div class='col-4 col-md-4 container'>
                                <img th:src="${l.getBook().getImage()}" width='226' height='349' alt='Book'/>
                            </div>
                            <div class='card col-3 col-md-3 container d-flex'>
                                <div class='card-body'>
                                    <div class='mt-3'>
                                        <h4>Loan Options</h4>

                                        <p th:if="${l.getDaysLeft() > 0}" class='text-secondary'>
                                            Due in <th:block th:text="${l.getDaysLeft()}"/> days.
                                        </p>


                                        <p th:if="${l.getDaysLeft() == 0}"class='text-success'>
                                            Due Today.
                                        </p>


                                        <p th:if="${l.getDaysLeft() < 0}"class='text-danger'>
                                            Past due by <th:block th:text="${l.getDaysLeft()}"/> days.
                                        </p>

                                        <div class='list-group mt-3'>
                                            <button class='list-group-item list-group-item-action'
                                                    aria-current='true' data-bs-toggle='modal'
                                                    th:attr="data-bs-target='\'#modal' + ${l.getBook().getId()} + '\''">
                                                Manage Loan
                                            </button>
                                            <a href='/search' class='list-group-item list-group-item-action'>
                                            Search more books?
                                            </a>
                                        </div>
                                    </div>
                                    <hr/>
                                    <p class='mt-3'>
                                        Help other find their adventure by reviewing your loan.
                                    </p>
                                    <a class='btn btn-primary' th:href="@{/reviews/form/{id}(id = ${l.getBook().getId()})}">
                                    Leave a review
                                    </a>
                                </div>
                            </div>

                        <hr/>
<!--                        <LoansModal shelfCurrentLoan={shelfCurrentLoan} mobile={false} returnBook={returnBook}-->
<!--                                    renewLoan={renewLoan}/>-->
                    </div>
                        </div>

                    </div>

                    <div th:if="${loans.size() == 0}">
                <h3 class='mt-3'>
                    Currently no loans
                </h3>
                    </div>

                <a class='btn btn-primary' href="/search">
                Search for a new book
                </a>

        </div>

<!--        {/* Mobile */}-->
<!--        <div class='container d-lg-none mt-2'>-->
<!--            {shelfCurrentLoans.length > 0 ?-->
<!--            <>-->
<!--            <h5 class='mb-3'>Current Loans: </h5>-->

<!--            {shelfCurrentLoans.map(shelfCurrentLoan => (-->
<!--            <div key={shelfCurrentLoan.book.id}>-->
<!--                <div class='d-flex justify-content-center align-items-center'>-->
<!--                    {shelfCurrentLoan.book?.image ?-->
<!--                    <img src={shelfCurrentLoan.book?.image} width='226' height='349' alt='Book'/>-->
<!--                    :-->
<!--                    <img src={require('./../../../Images/BooksImages/book-luv2code-1000.png')}-->
<!--                         width='226' height='349' alt='Book'/>-->
<!--                    }-->
<!--                </div>-->
<!--                <div class='card d-flex mt-5 mb-3'>-->
<!--                    <div class='card-body container'>-->
<!--                        <div class='mt-3'>-->
<!--                            <h4>Loan Options</h4>-->
<!--                            {shelfCurrentLoan.daysLeft > 0 &&-->
<!--                            <p class='text-secondary'>-->
<!--                                Due in {shelfCurrentLoan.daysLeft} days.-->
<!--                            </p>-->
<!--                            }-->
<!--                            {shelfCurrentLoan.daysLeft === 0 &&-->
<!--                            <p class='text-success'>-->
<!--                                Due Today.-->
<!--                            </p>-->
<!--                            }-->
<!--                            {shelfCurrentLoan.daysLeft < 0 &&-->
<!--                            <p class='text-danger'>-->
<!--                                Past due by {shelfCurrentLoan.daysLeft} days.-->
<!--                            </p>-->
<!--                            }-->
<!--                            <div class='list-group mt-3'>-->
<!--                                <button class='list-group-item list-group-item-action'-->
<!--                                        aria-current='true' data-bs-toggle='modal'-->
<!--                                        data-bs-target={`#mobilemodal${shelfCurrentLoan.book.id}`}>-->
<!--                                    Manage Loan-->
<!--                                </button>-->
<!--                                <Link to={'search'} class='list-group-item list-group-item-action'>-->
<!--                                Search more books?-->
<!--                                </Link>-->
<!--                            </div>-->
<!--                        </div>-->
<!--                        <hr/>-->
<!--                        <p class='mt-3'>-->
<!--                            Help other find their adventure by reviewing your loan.-->
<!--                        </p>-->
<!--                        <Link class='btn btn-primary' to={`/checkout/${shelfCurrentLoan.book.id}`}>-->
<!--                        Leave a review-->
<!--                        </Link>-->
<!--                    </div>-->
<!--                </div>-->

<!--                <hr/>-->
<!--                <LoansModal shelfCurrentLoan={shelfCurrentLoan} mobile={true} returnBook={returnBook}-->
<!--                            renewLoan={renewLoan}/>-->
<!--            </div>-->
<!--            ))}-->
<!--        </> :-->
<!--        <>-->
<!--        <h3 class='mt-3'>-->
<!--            Currently no loans-->
<!--        </h3>-->
<!--        <Link class='btn btn-primary' to={`search`}>-->
<!--        Search for a new book-->
<!--        </Link>-->
<!--    </>-->
<!--    }-->
<!--</div>-->


<!--            </div>-->
<!--            <div class='tab-pane fade' id='nav-history' role='tabpanel'-->
<!--                 aria-labelledby='nav-history-tab'>-->
<!--                <p>History here</p>-->
<!--        </div>-->
<!--    </div>-->
            </div>
        </div>
    </div>
      </div>


<th:block th:include="~{/fragments/nav-and-footer/footer}"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
        crossorigin="anonymous"></script>
</body>
</html>